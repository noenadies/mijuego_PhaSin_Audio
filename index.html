<!DOCTYPE html>
<html>
<head>
  <title>OCR con Tesseract.js, filtro y cámara</title>
</head>
<body>
  <video id="video" width="640" height="480" autoplay></video>
  <button id="snap">Tomar Foto</button>
  <canvas id="canvas"></canvas> <br/>
  <button id="process">Procesar Imagen</button>
  <div id="output"></div>

  <script src="https://unpkg.com/tesseract.js@v2/dist/tesseract.min.js"></script>
  <script>
 const _0x5d472f=_0xb571;function _0x5065(){const _0x2f8e92=['drawImage','getContext','spa','4subNXc','3068208nbAQQq','2723035nOmMcm','process','getImageData','facingMode','catch','16bBrPBm','click','log','2464bbdJMH','min','75280KhOTSU','getUserMedia','recognize','pow','videoWidth','1915290kYBJOL','toDataURL','width','max','2802RbZKmM','height','Ocurrió\x20un\x20error\x20al\x20acceder\x20a\x20la\x20cámara:\x20','innerText','getElementById','addEventListener','src','17489362OTFJyB','video','test','413276OtjROR','userAgent','putImageData','data','srcObject','image/jpeg','output','126fHAAOe','length','play','onload'];_0x5065=function(){return _0x2f8e92;};return _0x5065();}(function(_0x25d7f7,_0x226c7f){const _0x192d88=_0xb571,_0x52b024=_0x25d7f7();while(!![]){try{const _0x275e06=-parseInt(_0x192d88(0x201))/0x1*(-parseInt(_0x192d88(0x1e2))/0x2)+parseInt(_0x192d88(0x1f7))/0x3*(-parseInt(_0x192d88(0x1ec))/0x4)+parseInt(_0x192d88(0x1f3))/0x5+parseInt(_0x192d88(0x1e3))/0x6+parseInt(_0x192d88(0x1e4))/0x7*(parseInt(_0x192d88(0x1e9))/0x8)+parseInt(_0x192d88(0x208))/0x9*(parseInt(_0x192d88(0x1ee))/0xa)+-parseInt(_0x192d88(0x1fe))/0xb;if(_0x275e06===_0x226c7f)break;else _0x52b024['push'](_0x52b024['shift']());}catch(_0x2f8a01){_0x52b024['push'](_0x52b024['shift']());}}}(_0x5065,0x6b336));function fiter2(_0x14ad72,_0x52acb6=0x80){const _0x4b90d4=_0xb571;let _0x125485=_0x14ad72[_0x4b90d4(0x204)];for(let _0x186545=0x0;_0x186545<_0x125485[_0x4b90d4(0x209)];_0x186545+=0x4){let _0x198eb6=_0x125485[_0x186545]*0.299+_0x125485[_0x186545+0x1]*0.587+_0x125485[_0x186545+0x2]*0.114,_0x72dff0=_0x198eb6>=_0x52acb6?0xff:0x0;_0x125485[_0x186545]=_0x125485[_0x186545+0x1]=_0x125485[_0x186545+0x2]=_0x72dff0;}return _0x14ad72;}function contrastar(_0x4f3fff,_0x2e0348=0xa){const _0x12381a=_0xb571;var _0xa5eaa0=(0xff+_0x2e0348)/0xff;_0xa5eaa0*=_0xa5eaa0;for(var _0x2b0917=0x0;_0x2b0917<_0x4f3fff[_0x12381a(0x204)][_0x12381a(0x209)];_0x2b0917+=0x4){var _0x446023=_0x4f3fff[_0x12381a(0x204)][_0x2b0917]/0xff,_0x7c891e=_0x4f3fff[_0x12381a(0x204)][_0x2b0917+0x1]/0xff,_0x2ab278=_0x4f3fff[_0x12381a(0x204)][_0x2b0917+0x2]/0xff;_0x4f3fff[_0x12381a(0x204)][_0x2b0917]=((_0x446023-0.5)*_0xa5eaa0+0.5)*0xff,_0x4f3fff['data'][_0x2b0917+0x1]=((_0x7c891e-0.5)*_0xa5eaa0+0.5)*0xff,_0x4f3fff[_0x12381a(0x204)][_0x2b0917+0x2]=((_0x2ab278-0.5)*_0xa5eaa0+0.5)*0xff;}return _0x4f3fff;}function colorDivide(_0x2207b9){const _0x1329e4=_0xb571;var _0x1bada9=Math[_0x1329e4(0x1f6)](_0x2207b9['r'],Math[_0x1329e4(0x1f6)](_0x2207b9['g'],_0x2207b9['b'])),_0xa83b75=Math[_0x1329e4(0x1ed)](_0x2207b9['r'],Math[_0x1329e4(0x1ed)](_0x2207b9['g'],_0x2207b9['b']));return _0x1bada9<=0x0&&(_0x1bada9=0.01),_0xa83b75/_0x1bada9;}function gris(_0x3f3ba8,_0x26c9fe=0.4){const _0x44de14=_0xb571;let _0x183c05=_0x3f3ba8[_0x44de14(0x204)];var _0x4c519e={'r':0x0,'g':0x0,'b':0x0};for(let _0x49d55f=0x0;_0x49d55f<_0x183c05[_0x44de14(0x209)];_0x49d55f+=0x4){_0x4c519e['r']=_0x183c05[_0x49d55f]/0xff,_0x4c519e['g']=_0x183c05[_0x49d55f+0x1]/0xff,_0x4c519e['b']=_0x183c05[_0x49d55f+0x2]/0xff;let _0x52cd59=colorDivide(_0x4c519e),_0x5b0477=Math['max'](_0x4c519e['r'],_0x4c519e['g'],_0x4c519e['b']),_0x171798;if(_0x52cd59>0.9){let _0x457c82=0.2126*_0x4c519e['r']+0.7152*_0x4c519e['g']+0.0722*_0x4c519e['b'];_0x457c82=_0x5b0477,_0x171798=_0x457c82>_0x26c9fe?0xff:0x0;}else _0x171798=0x1;_0x5b0477<0.37&&(_0x171798=_0x5b0477*0.2),_0x171798=_0x5b0477*0.2,_0x171798=Math['pow'](_0x171798,0.4),_0x171798=_0x171798*1.3,_0x171798=_0x5b0477*0.35,_0x171798=Math[_0x44de14(0x1f1)](_0x171798,0.4),_0x171798=_0x171798*1.3,_0x4c519e['r']=_0x171798,_0x4c519e['g']=_0x171798,_0x4c519e['b']=_0x171798,_0x183c05[_0x49d55f]=_0x4c519e['r']*0xff,_0x183c05[_0x49d55f+0x1]=_0x4c519e['g']*0xff,_0x183c05[_0x49d55f+0x2]=_0x4c519e['b']*0xff;}return _0x3f3ba8;}const video=document[_0x5d472f(0x1fb)](_0x5d472f(0x1ff)),canvas=document[_0x5d472f(0x1fb)]('canvas'),ctx=canvas[_0x5d472f(0x1e0)]('2d'),snap=document[_0x5d472f(0x1fb)]('snap'),processButton=document['getElementById'](_0x5d472f(0x1e5)),outputDiv=document[_0x5d472f(0x1fb)](_0x5d472f(0x207));function startCamera(_0x4ccf11){const _0x44ace3=_0x5d472f;navigator['mediaDevices'][_0x44ace3(0x1ef)](_0x4ccf11)['then'](function(_0x211e57){const _0x34bfa9=_0x44ace3;video[_0x34bfa9(0x205)]=_0x211e57,video[_0x34bfa9(0x20a)]();})[_0x44ace3(0x1e8)](function(_0x453c56){const _0x9019de=_0x44ace3;console[_0x9019de(0x1eb)](_0x9019de(0x1f9),_0x453c56),_0x4ccf11[_0x9019de(0x1ff)][_0x9019de(0x1e7)]&&startCamera({'video':!![],'audio':![]});});}function _0xb571(_0x2db1f7,_0x471f57){const _0x506588=_0x5065();return _0xb571=function(_0xb57174,_0x37c7ec){_0xb57174=_0xb57174-0x1e0;let _0x23dba5=_0x506588[_0xb57174];return _0x23dba5;},_0xb571(_0x2db1f7,_0x471f57);}/Mobi|Android/i[_0x5d472f(0x200)](navigator[_0x5d472f(0x202)])?startCamera({'video':{'facingMode':{'exact':'environment'}},'audio':![]}):startCamera({'video':!![],'audio':![]});snap[_0x5d472f(0x1fc)](_0x5d472f(0x1ea),()=>{const _0x22d380=_0x5d472f;canvas['width']=video[_0x22d380(0x1f2)],canvas['height']=video['videoHeight'],ctx[_0x22d380(0x20c)](video,0x0,0x0,canvas['width'],canvas[_0x22d380(0x1f8)]),setTimeout(()=>{apertetomafotocanvas();},0x3e8);}),processButton['addEventListener'](_0x5d472f(0x1ea),()=>{const _0x34c87e=_0x5d472f;let _0x88941=ctx[_0x34c87e(0x1e6)](0x0,0x0,canvas[_0x34c87e(0x1f5)],canvas[_0x34c87e(0x1f8)]);_0x88941=gris(_0x88941),ctx[_0x34c87e(0x203)](_0x88941,0x0,0x0),Tesseract[_0x34c87e(0x1f0)](canvas,_0x34c87e(0x1e1),{'logger':_0x42fc2e=>console['log'](_0x42fc2e)})['then'](({data:{text:_0x4d3fe5}})=>{const _0x278ed1=_0x34c87e;outputDiv[_0x278ed1(0x1fa)]=_0x4d3fe5;});});var bolpase2=![];function apertetomafotocanvas(_0xb1a7c5){const _0x53c9c7=_0x5d472f;let _0x4eac67=new Image();_0x4eac67['src']=canvas[_0x53c9c7(0x1f4)](_0x53c9c7(0x206),0x1),_0x4eac67[_0x53c9c7(0x20b)]=()=>{const _0x31a728=_0x53c9c7;!bolpase2?(bolpase2=!![],_0xb1a7c5=gris(_0xb1a7c5),ctx[_0x31a728(0x203)](_0xb1a7c5,0x0,0x0),_0x4eac67[_0x31a728(0x1fd)]=canvas[_0x31a728(0x1f4)]('image/jpeg',0x1)):Tesseract['recognize'](canvas,'spa',{'logger':_0x3da25c=>console['log'](_0x3da25c)})['then'](({data:{text:_0x452670}})=>{const _0x86f079=_0x31a728;outputDiv[_0x86f079(0x1fa)]=_0x452670,bolpase2=![],_0x4eac67=null;});};}
  </script>
</body>
</html>
